!function(e){"use strict";var t={activeElement:void 0,lastActive:void 0,stackedElements:[],tabbableElements:"a[href], area[href], input:not([disabled]),select:not([disabled]), textarea:not([disabled]),button:not([disabled]), iframe, object, embed, *[tabindex],*[contenteditable]",on:function(e,t,n){if("string"!=typeof e)throw new Error("Type error: `error` has to be a string");if("function"!=typeof n)throw new Error("Type error: `callback` has to be a function");t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},trigger:function(e,t){var n;window.CustomEvent&&(n=new CustomEvent(e,{detail:{modal:t}}),document.dispatchEvent(n))},addClass:function(e,t){e&&!e.className.match(t)&&(e.className+=" "+t)},removeClass:function(e,t){e.className=e.className.replace(t,"").replace("  "," ")},setFocus:function(){t.activeElement&&(t.lastActive=document.activeElement,t.activeElement.focus(),t.keepFocus(t.activeElement))},removeFocus:function(){t.lastActive&&t.lastActive.focus()},keepFocus:function(e){var n=e.querySelectorAll(t.tabbableElements),a=n[0],o=n[n.length-1],c=function(e){var t=e.which||e.keyCode;9===t&&(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},e.target!==o||e.shiftKey?e.target===a&&e.shiftKey&&(e.preventDefault(),o.focus()):(e.preventDefault(),a.focus()))};t.on("keydown",e,c)},setActive:function(e){t.addClass(e,"is-active"),t.activeElement=e,t.activeElement.setAttribute("aria-hidden","false"),t.setFocus(e.id),t.trigger("cssmodal:show",t.activeElement)},unsetActive:function(e){t.activeElement&&(t.removeClass(t.activeElement,"is-active"),t.trigger("cssmodal:hide",t.activeElement),t.activeElement.setAttribute("aria-hidden","true"),t.removeFocus(),e&&t.stackModal(t.activeElement),!e&&t.stackedElements.length>0&&t.unstackModal(),t.activeElement=null)},stackModal:function(e){t.addClass(e,"is-stacked"),t.stackedElements.push(t.activeElement)},unstackModal:function(){var e=t.stackedElements.length,n=t.stackedElements[e-1];t.removeClass(n,"is-stacked"),window.location.hash=n.id,t.stackedElements.splice(e-1,1)},mainHandler:function(){var e,n=window.location.hash.replace("#",""),a=document.getElementById(n);a?(e=a.children[0],e&&e.className.match(/modal-inner/)&&(t.addClass(document.documentElement,"has-overlay"),t.unsetActive(!0),t.setActive(a))):(t.removeClass(document.documentElement,"has-overlay"),t.unsetActive())}};t.on("keyup",document,function(e){var n=window.location.hash.replace("#","");if(""!==n&&"!"!==n&&27===e.keyCode){if(window.location.hash="!",t.lastActive)return!1;t.removeFocus()}},!1),t.on("hashchange",window,t.mainHandler),t.on("load",window,t.mainHandler),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=t:"function"==typeof define&&define.amd?define([],function(){return t}):"object"==typeof e&&"object"==typeof e.document&&(e.CSSModal=t)}(window);