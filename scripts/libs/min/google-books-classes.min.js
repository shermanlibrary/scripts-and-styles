!function(){function e(e,t,s){e.addEventListener?(e.addEventListener(t,s,!1),o.add(e,t,s)):e.attachEvent?(e["e"+t+s]=s,e[t+s]=function(){e["e"+t+s](window.event)},e.attachEvent("on"+t,e[t+s]),o.add(e,t,s)):e["on"+t]=e["e"+t+s]}function t(){document.addEventListener&&!gbs.browser.opera&&document.addEventListener("DOMContentLoaded",gbs.ready,!1),gbs.browser.msie&&window==top&&function(){if(!gbs.isReady){try{document.documentElement.doScroll("left")}catch(e){return setTimeout(arguments.callee,0),void 0}gbs.ready()}}(),gbs.browser.opera&&document.addEventListener("DOMContentLoaded",function(){if(!gbs.isReady){for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].disabled)return setTimeout(arguments.callee,0),void 0;gbs.ready()}},!1),gbs.browser.safari&&!function(){return gbs.isReady?void 0:"loaded"!=document.readyState&&"complete"!=document.readyState?(setTimeout(arguments.callee,0),void 0):(gbs.ready(),void 0)}(),e(window,"load",gbs.ready)}function s(e){return e.replace(/^\s+|\s+$/g,"")}function n(e){for(var t=document.getElementsByTagName("td"),n=0;n<t.length;n++)if("bibInfoLabel"==t[n].className){var a=s(t[n].innerText||t[n].textContent||"");if(new RegExp(e).test(a)){for(var r=t[n].nextSibling;null!=r&&"TD"!=r.tagName&&"bibInfoData"!=r.className;)r=r.nextSibling;if(null==r)break;var a=s(r.innerText||r.textContent||"");if("ISBN"==e){var i=a.match(/^((\d|x){10,13}).*/i);if(i)return"ISBN:"+i[1]}else if("OCLC"==e)return"OCLC:0000000"}}return null}function a(e){for(u=new Object;e.length>0;){var t=e.pop();t.expanded||r(t)}var s=new Array;for(var n in u)s.push(n);if(0!=s.length){s=s.join(",");var a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src","http://books.google.com/books?jscmd=viewapi&bibkeys="+s+"&callback=gbs.ProcessResults"),document.documentElement.firstChild.appendChild(a)}}function r(e){function t(e,t,s){e.success.push(function(e,n){if(void 0!==n[t]){var a=e.span.parentNode,r=e.span.nextSibling;a.removeChild(e.span);var i=document.createElement("a");i.setAttribute("href",n[t]),void 0!=s&&i.setAttribute("target","_"+s),i.appendChild(e.span),a.insertBefore(i,r)}})}function a(e){var t=e.span;for(null!=t.style&&"none"==t.style.display&&(t.style.display="inline");null!=t;t=t.parentNode)null!=t.style&&"none"==t.style.display&&(t.style.display="block")}function r(e,s){var n=e.match(/gbs-link-to-(preview|info|thumbnail)(-(\S+))?/);if(n)return t(s,n[1]+"_url",n[3]),!0;switch(e){case"gbs-thumbnail":case"gbs-thumbnail-large":s.success.push(function(t,s){if(s.thumbnail_url){var n=document.createElement("img"),a=s.thumbnail_url;"gbs-thumbnail-large"==e&&(a+="&zoom=1"),n.setAttribute("src",a),t.span.appendChild(n)}});break;case"gbs-embed-viewer":s.success.push(function(e,t){if(t.embeddable){var s=new google.books.DefaultViewer(e.span);s.load(e.getSearchItem())}});break;case"gbs-if-noview":case"gbs-if-partial-or-full":case"gbs-if-partial":case"gbs-if-full":s.gbsif=e.replace(/gbs-if-/,""),s.useConditionalVisible=!0,s.success.push(function(e,t){if("partial-or-full"==e.gbsif)var s="partial"==t.preview||"full"==t.preview;else var s=t.preview==e.gbsif;s?a(e):e.span.parentNode.removeChild(e.span)});break;case"gbs-remove-on-failure":s.failure.push(function(e){e.span.parentNode.removeChild(e.span)});break;case"gbs-remove-on-success":s.success.push(function(e){e.span.parentNode.removeChild(e.span)});break;default:return!1}return!0}var i=e.className;if(null!=i){var o={span:e,removeTitle:function(){this.span.setAttribute("title","")},success:new Array,failure:new Array,onsuccess:function(e){for(var t=0;t<this.success.length;t++)try{this.success[t](this,e)}catch(s){}this.removeTitle(),this.useConditionalVisible||a(this)},onfailure:function(e){for(var t=0;t<this.failure.length;t++)try{this.failure[t](this,e)}catch(s){}this.removeTitle()},getSearchItem:function(){if(null!=this.searchitem)return this.searchitem;var e=this.span.getAttribute("title");if("*"==e||"OCLC:*"==e||"LCCN:*"==e){var t=this.span.innerText||this.span.textContent||"";switch(t=s(t),this.searchitem=t,e){case"*":var a=t.match(/^((\d|x){10,13}).*/i);a&&(this.searchitem="ISBN:"+a[1]);break;case"OCLC:*":t=t.replace(/^[\s\S]*?(oc[mn])?(\d+)[\s\S]*/,"$2"),this.searchitem="OCLC:"+t;break;case"LCCN:*":this.searchitem="LCCN:"+t}this.span.hasChildNodes()&&this.span.removeChild(this.span.firstChild)}else this.searchitem=null!=(a=e.match(/(.*):millennium.record/))?n(a[1]):e.toLowerCase();return this.searchitem}},l=!1,c=i.split(/\s+/);o.useConditionalVisible=!1;for(var d=0;d<c.length;d++)r(c[d],o)&&(l=!0);if(l){var f=o.getSearchItem();null!=f&&(void 0===u[f]?u[f]=[o]:u[f].push(o),o.span.expanded=!0)}}}function i(){for(var e=document.getElementsByTagName("span"),t=new Array,s=0;s<e.length;s++)t.push(e[e.length-1-s]);for(var n=document.getElementsByTagName("div"),s=0;s<n.length;s++)t.push(n[n.length-1-s]);a(t)}gbs={isReady:!1,readyListeners:new Array};var o=function(){var e=[];return{listEvents:e,add:function(){e.push(arguments)},flush:function(){var t,s;for(t=e.length-1;t>=0;t-=1)s=e[t],s[0].removeEventListener&&s[0].removeEventListener(s[1],s[2],s[3]),"on"!=s[1].substring(0,2)&&(s[1]="on"+s[1]),s[0].detachEvent&&s[0].detachEvent(s[1],s[2]),s[0][s[1]]=null}}}();e(window,"unload",o.flush);var l=navigator.userAgent.toLowerCase();gbs.browser={version:(l.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(l),opera:/opera/.test(l),msie:/msie/.test(l)&&!/opera/.test(l),mozilla:/mozilla/.test(l)&&!/(compatible|webkit)/.test(l)},gbs.ready=function(){if(!gbs.isReady){gbs.isReady=!0;for(var e=0;e<gbs.readyListeners.length;e++)gbs.readyListeners[e]()}};var u;gbs.ProcessResults=function(e){for(var t in e){var s=e[t];if(req=u[s.bib_key],null!=req&&void 0!=req){for(var n=0;n<req.length;n++)req[n].onsuccess(s);delete u[s.bib_key]}}for(var t in u)if(req=u[t],null!=req){for(var n=0;n<req.length;n++)req[n].onfailure();delete u[t]}},gbs.readyListeners.push(i),t(),"undefined"!=typeof google&&"function"==typeof google.load&&google.load("books","0")}();