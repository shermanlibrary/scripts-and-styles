function addEvent(e,a,n){e.addEventListener?(e.addEventListener(a,n,!1),EventCache.add(e,a,n)):e.attachEvent?(e["e"+a+n]=n,e[a+n]=function(){e["e"+a+n](window.event)},e.attachEvent("on"+a,e[a+n]),EventCache.add(e,a,n)):e["on"+a]=e["e"+a+n]}function majaxProcessRemainingSpans(e){function a(e,a){var n=e.match(/majax-marc-(\d\d\d)-(\S)/);if(null==n&&(n=e.match(/majax-marc-(\d\d\d)/)),n)return a.success.push(function(e,a){var t,s=a.marc["f"+n[1]];if(n[2])t=s[n[2]]+" ";else{var i="abcdefghijklmnopqrstuvwxyz0123456789";t="";for(var r=0;r<i.length;r++){var c=s[i.charAt(r)];void 0!==c&&(t+=c+" ")}}e.span.appendChild(document.createTextNode(t))}),!0;var t=e.match(/majax-syndetics-(\S+)/i);if(t){var s=t[1];return a.success.push(function(e){var a=e.getSearchItem();if("i"==a.charAt(0)){var n=document.createElement("img"),t=a.substring(1);n.setAttribute("src","http://syndetics.com/hw7.pl?isbn="+t+"/SC.GIF&client="+s),e.span.appendChild(n)}}),!0}switch(e){case"majax-showholdings-div":case"majax-shd":a.success.push(function(e,a){for(var n="",t=0;t<a.holdings.length;t++)n+="Copy "+(t+1)+": "+a.holdings[t].toLowerCase()+"<br />";var s=document.createElement("div");s.innerHTML=n,e.span.appendChild(s)});break;case"majax-newline":case"majax-nl":a.success.push(function(e){e.span.appendChild(document.createElement("br"))});break;case"majax-space":case"majax-s":a.success.push(function(e){e.span.appendChild(document.createTextNode(" "))});break;case"majax-showholdings-brief":case"majax-shb":a.success.push(function(e,a){for(var n=!1,t="",s=0;s<a.holdings.length;s++)a.holdings[s].match(isAvailableRegex)&&(n=!0),t+=(0==s?"":" ")+a.holdings[s].toLowerCase();if(n)t=itemAvailableMsg;else switch(a.holdings.length){case 1:t=singleItemUnavailable.replace(/%s/,t);break;case 0:t=noCopyHeld,a.marc.f856&&a.marc.f856.u&&(t="");break;default:t=multipleItemsUnavailable.replace(/%s/,t)}e.span.appendChild(document.createTextNode(t))});break;case"majax-showholdings":case"majax-sh":a.success.push(function(e,a){for(var n="",t=!1,s=0;s<a.holdings.length;s++)n+=(0==s?"":", ")+a.holdings[s].toLowerCase(),a.holdings[s].match(isAvailableRegex)&&(t=!0);switch(a.holdings.length){case 0:n=noCopiesFound,a.marc.f856&&a.marc.f856.u&&(n="");break;case 1:n=singleCopyStatus.replace(/%s/,n);break;default:n=multipleCopyStatus.replace(/%n/,a.holdings.length).replace(/%s/,n)}e.span.appendChild(document.createTextNode(n))});break;case"majax-reportfailure":case"majax-rf":a.failure.push(function(e){var a=e.printSearchItem()+" not found";e.span.appendChild(document.createTextNode(a))});break;case"majax-endnote":case"majax-en":a.success.push(function(e,a){var n=document.createElement("PRE");n.className+="majax-endnote-style",n.appendChild(document.createTextNode(a.endnote)),e.span.appendChild(n)});break;case"majax-endnote-switch":case"majax-ens":a.success.push(function(e,a){var n=a.majaxMakeEndnoteDisplay(document," Endnote","Show","Hide","majax-endnote-style");e.span.appendChild(n)});break;case"majax-harvard-reference":case"majax-hr":a.success.push(function(e,a){e.span.innerHTML+=a.majaxMakeHarvardReference()});break;case"majax-endnote-import":case"majax-eni":a.success.push(function(e,a){var n=a.majaxMakeEndnoteImport(document);n.appendChild(document.createTextNode("Click here to import into EndNote")),e.span.appendChild(n)});break;case"majax-ebook":case"majax-eb":a.success.push(function(e,a){try{if(null!=a.marc.f856.subfields["3"])return;var n=document.createElement("a");n.setAttribute("href",a.marc.f856.u),n.appendChild(document.createTextNode(electronicBookMsg)),e.span.appendChild(n)}catch(t){}});break;case"majax-linktocatalog":case"majax-l":a.success.push(function(e){var a=e.span.parentNode,n=e.span.nextSibling;a.removeChild(e.span);var t=document.createElement("a");t.setAttribute("href",majax.majaxSearchURL(e.getSearchItem())),t.appendChild(e.span),a.insertBefore(t,n)});break;default:return!1}return!0}for(var n=0;e.length>0;){var t=e.pop();if(!t.expanded){var s=t.className;if(null!=s){for(var i={span:t,removeTitle:function(){this.span.setAttribute("title","")},success:new Array,failure:new Array,onsuccess:function(e){for(var a=0;a<this.success.length;a++)try{this.success[a](this,e)}catch(n){}this.removeTitle()},onfailure:function(e){for(var a=0;a<this.failure.length;a++)try{this.failure[a](this,e)}catch(n){}this.removeTitle()},getSearchItem:function(){if(void 0===this.searchitem){var e,a=this.span.getAttribute("title");if(null!=(e=a.match(/^(o|i|t|\.b)\*$/))){var n=this.span.innerText||this.span.textContent||"";if(n=n.trim().toLowerCase(),"i"==e[1]){var t=n.match(/((\d|x|X){10,13})/);t&&(n=t[1])}for(this.searchitem=e[1]+n;this.span.hasChildNodes();)this.span.removeChild(this.span.firstChild);this.span.style.display="inline"}else this.searchitem=a.toLowerCase()}return this.searchitem},printSearchItem:function(){var e,a=this.searchitem;return null!=(e=a.match(/^o(\S*)/))?"OCLC# '"+e[1]+"'":null!=(e=a.match(/^i(\S*)/))?"ISBN '"+e[1]+"'":null!=(e=a.match(/^t(\S*)/))?"Title '"+e[1]+"'":null!=(e=a.match(/^\.(b\S*)/))?"Bibrecord '"+e[1]+"'":void 0}},r=!1,c=s.split(/\s+/),o=0;o<c.length;o++)a(c[o],i)&&(r=!0);if(r&&(i.span.expanded=!0,majax.majaxSearch(i.getSearchItem(),i),++n>=2))return window.setTimeout(function(){majaxProcessRemainingSpans(e)},100),void 0}}}}function majaxProcessSpans(){for(var e=document.getElementsByTagName("span"),a=new Array,n=0;n<e.length;n++)a[n]=e[e.length-1-n];majaxProcessRemainingSpans(a)}function majaxLoaded(){majax.debug=!1;for(var e=0;e<majaxLoadHandlers.length;e++)majaxLoadHandlers[e]();majax.loaded=!0,majaxProcessSpans()}function majaxOnLoad(){try{var e=document.createElement("IFRAME");e.setAttribute("id","hiddeniframe"),e.setAttribute("name","hiddeniframe");var a=document.getElementsByTagName("script");for(var n in a){var t=a[n];if(t.src&&t.src.match(/.*\/majax.js/)){var s=t.src.replace(/.js$/,".html");e.setAttribute("src",s);break}}e.style.display="none",addEvent(e,"load",majaxLoaded),document.body.appendChild(e),majax=document.frames?document.frames.hiddeniframe:document.getElementById("hiddeniframe").contentWindow}catch(i){alert(i)}}function majaxRunBeforeSpanProcessing(e){void 0!==majax&&majax.loaded?(e(),majaxProcessSpans()):majaxLoadHandlers.push(e)}if(!isAvailableRegex)var isAvailableRegex=/AVAILABLE/;if(!noCopiesFound)var noCopiesFound="No copies found.";if(!singleCopyStatus)var singleCopyStatus="1 copy is %s";if(!multipleCopyStatus)var multipleCopyStatus="%n copies found: %s";if(!itemAvailableMsg)var itemAvailableMsg="Available";if(!noCopyHeld)var noCopyHeld="No copy held";if(!singleItemUnavailable)var singleItemUnavailable="%s";if(!multipleItemsUnavailable)var multipleItemsUnavailable="No copy currently available (copies are %s)";var electronicBookMsg="[Electronic Book]",EventCache=function(){var e=[];return{listEvents:e,add:function(){e.push(arguments)},flush:function(){var a,n;for(a=e.length-1;a>=0;a-=1)n=e[a],n[0].removeEventListener&&n[0].removeEventListener(n[1],n[2],n[3]),"on"!=n[1].substring(0,2)&&(n[1]="on"+n[1]),n[0].detachEvent&&n[0].detachEvent(n[1],n[2]),n[0][n[1]]=null}}}();addEvent(window,"unload",EventCache.flush),String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var majax,majaxLoadHandlers=new Array;try{var superdomain=document.domain.replace(/.*\.(([^.]+\.){1}[^.]+)$/,"$1");document.domain=superdomain}catch(e){alert("majax: Cannot set document.domain to "+superdomain)}addEvent(window,"load",majaxOnLoad);